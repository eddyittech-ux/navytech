<!DOCTYPE html>
<html lang="es" class="h-full">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>NavyTech</title>

  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    // Tokens base + Glass Studio
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            brand: { gold: '#C7A740' },
            eddy: { indigo: '#3F3D8F' },
            dani: { navy: '#163054' }
          },
          boxShadow: {
            'glass': '0 8px 32px rgba(0,0,0,0.25)',
            'glass-sm': '0 4px 16px rgba(0,0,0,0.18)'
          },
          backdropBlur: { xs: '2px' }
        }
      }
    }
  </script>
  <style>
    /* Helpers mínimos encima de Tailwind */
    .gs-card {
      @apply rounded-2xl shadow-glass bg-white/10 dark:bg-white/5 backdrop-blur-md border border-white/20 dark:border-white/10;
    }
    .gs-btn {
      @apply rounded-xl px-4 py-2 font-medium shadow-glass-sm;
    }
    .gs-input {
      @apply w-full rounded-xl border border-white/30 dark:border-white/10 bg-white/60 dark:bg-white/10 backdrop-blur px-3 py-2 outline-none focus:ring-2 focus:ring-brand-gold;
    }
    .gs-label {@apply text-sm opacity-80;}
    .gs-chip {@apply text-xs px-2 py-1 rounded-full border border-white/30 bg-white/10;}
    .gs-icon { width: 20px; height: 20px; }
    .hidden-vis { display: none; } /* toggle helpers */
  </style>
</head>
<body class="h-full bg-gradient-to-br from-slate-100 to-slate-200 dark:from-slate-900 dark:to-slate-950 text-slate-900 dark:text-slate-100">

  <!-- Header -->
  <header class="sticky top-0 z-40 backdrop-blur bg-white/40 dark:bg-slate-900/40 border-b border-white/20 dark:border-white/10">
    <div class="max-w-5xl mx-auto px-4 py-3 flex items-center gap-3">
      <div class="flex items-center gap-2">
        <!-- Logo simple -->
        <div class="w-8 h-8 rounded-xl bg-gradient-to-br from-dani-navy to-eddy-indigo"></div>
        <h1 class="text-lg font-semibold tracking-tight">NavyTech</h1>
      </div>

      <!-- Nav -->
      <nav class="ml-6 flex gap-1 text-sm">
        <a href="#/resumen" class="px-3 py-2 rounded-lg hover:bg-white/40 dark:hover:bg-white/10">Resumen</a>
        <a href="#/acuerdos" class="px-3 py-2 rounded-lg hover:bg-white/40 dark:hover:bg-white/10">Acuerdos</a>
        <a href="#/metas" class="px-3 py-2 rounded-lg hover:bg-white/40 dark:hover:bg-white/10">Metas</a>
        <a href="#/luces" class="px-3 py-2 rounded-lg hover:bg-white/40 dark:hover:bg-white/10">Luces</a>
        <a href="#/juegos" class="px-3 py-2 rounded-lg hover:bg-white/40 dark:hover:bg-white/10">Juegos</a>
        <a href="#/ajustes" class="px-3 py-2 rounded-lg hover:bg-white/40 dark:hover:bg-white/10">Ajustes</a>
      </nav>

      <div class="ml-auto flex items-center gap-2">
        <!-- Theme switch -->
        <button id="themeToggle" class="gs-btn bg-white/40 dark:bg-white/10 border border-white/30" title="Tema">
          <span id="themeLabel" class="text-xs">Dark</span>
        </button>

        <!-- User chip + logout -->
        <div id="userChip" class="flex items-center gap-2">
          <span id="userEmail" class="text-xs opacity-80"></span>
          <button id="logoutBtn" class="gs-btn bg-white/40 dark:bg-white/10 border border-white/30">Salir</button>
        </div>
      </div>
    </div>
  </header>

  <!-- Main -->
  <main class="max-w-5xl mx-auto px-4 py-6">
    <!-- Auth card -->
    <section id="authCard" class="gs-card p-6 max-w-md mx-auto">
      <h2 class="text-xl font-semibold mb-4">Iniciar sesión</h2>
      <form id="loginForm" class="space-y-3">
        <div>
          <label class="gs-label">Email</label>
          <input id="emailInput" type="email" class="gs-input" placeholder="tu@email.com" required>
        </div>
        <div>
          <label class="gs-label">Password</label>
          <input id="passwordInput" type="password" class="gs-input" placeholder="••••••••" required>
        </div>
        <button class="gs-btn bg-brand-gold/90 hover:bg-brand-gold text-slate-900">Entrar</button>
      </form>
      <p class="text-xs opacity-70 mt-2">Solo usuarios permitidos (Eddy y Dani).</p>
    </section>

    <!-- App views -->
    <section id="appViews" class="space-y-6 hidden-vis">
      <!-- Resumen -->
      <div id="view-resumen" class="gs-card p-5">
        <div class="flex items-center justify-between mb-4">
          <h2 class="text-lg font-semibold">Resumen</h2>
          <span class="text-xs opacity-70">v0.1</span>
        </div>
        <div id="resumeStats" class="grid grid-cols-1 sm:grid-cols-3 gap-4">
          <!-- Cards de estadísticas se inyectan desde UI -->
        </div>
      </div>

      <!-- Contactos (dentro de Ajustes fase1) -->
      <div id="view-ajustes" class="gs-card p-5">
        <div class="flex items-center justify-between mb-4">
          <h2 class="text-lg font-semibold">Ajustes · Contactos</h2>
          <div class="flex items-center gap-2">
            <select id="filterStatus" class="gs-input !w-auto text-sm">
              <option value="">Todos</option>
              <option>Bloqueado</option>
              <option>Silenciado</option>
              <option>Archivado</option>
              <option>Eliminado</option>
              <option>Inaccesible</option>
              <option>Conservado</option>
            </select>
            <button id="addContactFab" class="gs-btn bg-white/40 dark:bg-white/10 border border-white/30">+ Agregar</button>
          </div>
        </div>
        <div id="contactsList" class="grid gap-3">
          <!-- Items de contactos -->
        </div>
      </div>

      <!-- Placeholders de módulos (para no romper router) -->
      <div id="view-acuerdos" class="gs-card p-5 hidden-vis"><h2 class="text-lg font-semibold mb-2">Acuerdos</h2><p class="opacity-70 text-sm">Próxima fase.</p></div>
      <div id="view-metas" class="gs-card p-5 hidden-vis"><h2 class="text-lg font-semibold mb-2">Metas</h2><p class="opacity-70 text-sm">Próxima fase.</p></div>
      <div id="view-luces" class="gs-card p-5 hidden-vis"><h2 class="text-lg font-semibold mb-2">Luces</h2><p class="opacity-70 text-sm">Próxima fase.</p></div>
      <div id="view-juegos" class="gs-card p-5 hidden-vis"><h2 class="text-lg font-semibold mb-2">Juegos</h2><p class="opacity-70 text-sm">Próxima fase.</p></div>
    </section>
  </main>

  <!-- Modal Contacto -->
  <dialog id="contactModal" class="rounded-2xl w-full max-w-lg p-0 backdrop:bg-black/50">
    <form id="contactForm" method="dialog" class="gs-card p-5">
      <div class="flex items-center justify-between mb-3">
        <h3 id="modalTitle" class="text-lg font-semibold">Nuevo contacto</h3>
        <button type="button" id="closeModal" class="opacity-70 hover:opacity-100">✕</button>
      </div>

      <input type="hidden" id="contactId">

      <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
        <div>
          <label class="gs-label">Owner</label>
          <select id="ownerInput" class="gs-input" required>
            <option value="Eddy">Eddy</option>
            <option value="Dani">Dani</option>
          </select>
        </div>
        <div class="sm:col-span-2">
          <label class="gs-label">Nombre</label>
          <input id="nameInput" class="gs-input" required>
        </div>
        <div>
          <label class="gs-label">Categoría</label>
          <select id="categoryInput" class="gs-input">
            <option>Rojo</option><option>Ámbar</option><option>Verde</option><option>Azul</option>
          </select>
        </div>
        <div>
          <label class="gs-label">Estado</label>
          <select id="statusInput" class="gs-input">
            <option></option>
            <option>Bloqueado</option><option>Silenciado</option><option>Archivado</option>
            <option>Eliminado</option><option>Inaccesible</option><option>Conservado</option>
          </select>
        </div>
        <div class="sm:col-span-2">
          <label class="gs-label">Action plan</label>
          <input id="actionPlanInput" class="gs-input" placeholder="(catálogo, fase 2)">
        </div>
        <div class="sm:col-span-2">
          <label class="gs-label">Notas</label>
          <textarea id="notesInput" class="gs-input" rows="3"></textarea>
        </div>
      </div>

      <div class="mt-4 flex justify-end gap-2">
        <button type="button" id="deleteBtn" class="gs-btn border border-white/30 bg-white/20 text-red-300 hidden-vis">Eliminar</button>
        <button class="gs-btn bg-brand-gold/90 hover:bg-brand-gold text-slate-900">Guardar</button>
      </div>
    </form>
  </dialog>

  <!-- Toasts -->
  <div id="toastHost" class="fixed bottom-4 right-4 space-y-2"></div>

  <!-- Config -->
  <script>
    window.__NT_CONFIG__ = {
      supabaseUrl: "https://zhavnscqhsedrvokeocb.supabase.co",
      supabaseAnonKey: "REEMPLAZA_CON_TU_ANON_KEY"
    };
  </script>

  <!-- App scripts -->
  <script src="https://unpkg.com/@supabase/supabase-js@2.47.10/dist/umd/supabase.js"></script>
  <script src="./app.js"></script>
  <script src="./ui.js"></script>
</body>
</html>
