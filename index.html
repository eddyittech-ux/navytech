<!DOCTYPE html>
<html lang="es" class="h-full">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>NavyTech</title>

  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Estilo “Glass Studio” (sin build) -->
  <style>
    :root{
      --bg-grad-1:#f3f6fb; --bg-grad-2:#e9eef7;
      --card-bg: rgba(255,255,255,0.10);
      --border:  rgba(255,255,255,0.22);
      --input-bg:rgba(255,255,255,0.60);
    }
    .dark:root,.dark{
      --bg-grad-1:#0f172a; --bg-grad-2:#0b1220;
      --card-bg: rgba(255,255,255,0.06);
      --border:  rgba(255,255,255,0.10);
      --input-bg:rgba(255,255,255,0.10);
    }
    body{
      background: radial-gradient(1200px 800px at 10% -10%, var(--bg-grad-2), transparent),
                  radial-gradient(1000px 600px at 90% 10%, var(--bg-grad-2), transparent),
                  linear-gradient(180deg, var(--bg-grad-1), var(--bg-grad-2));
    }
    .gs-card{ border-radius: 16px; box-shadow: 0 8px 32px rgba(0,0,0,.25);
      -webkit-backdrop-filter: blur(10px); backdrop-filter: blur(10px);
      border: 1px solid var(--border); background: var(--card-bg); }
    .gs-btn{ border-radius: 12px; padding: 8px 14px; font-weight: 500;
      box-shadow: 0 4px 16px rgba(0,0,0,.18); border: 1px solid var(--border);
      background: rgba(255,255,255,.40); }
    .dark .gs-btn{ background: rgba(255,255,255,.10); }
    .gs-input{ width: 100%; border-radius: 12px; border: 1px solid var(--border);
      background: var(--input-bg); padding: 10px 12px; outline: none; }
    .gs-input:focus{ box-shadow: 0 0 0 2px #C7A740AA; }
    .gs-label{ font-size: .875rem; opacity:.8; display:block; margin-bottom:4px; }
    .gs-chip{ font-size:.75rem; padding:4px 8px; border-radius:999px; border:1px solid var(--border); background: rgba(255,255,255,.10); }
    .gs-icon{ width:20px; height:20px; }
    .hidden-vis{ display:none; }

    .nav-link{ color:inherit; }
    .nav-link.active{ background: rgba(255,255,255,.14); border:1px solid var(--border); border-radius: 10px; }

    .tooltip{ position:absolute; right:0; top:110%; background: rgba(0,0,0,.72); color:white;
      font-size:.75rem; padding:6px 8px; border-radius:8px; white-space:nowrap;
      border:1px solid rgba(255,255,255,.2); box-shadow: 0 8px 24px rgba(0,0,0,.25); pointer-events:none; }
  </style>
</head>
<body class="h-full text-slate-900 dark:text-slate-100">

  <!-- Header -->
  <header class="sticky top-0 z-40 backdrop-blur bg-white/40 dark:bg-slate-900/40 border-b border-white/20 dark:border-white/10">
    <div class="max-w-5xl mx-auto px-4 py-3 flex items-center gap-3">
      <div class="flex items-center gap-2 select-none">
        <div class="w-8 h-8 rounded-xl" style="background: linear-gradient(135deg,#163054 0%,#3F3D8F 70%);"></div>
        <h1 class="text-lg font-semibold tracking-tight">
          <span style="color:#163054">Navy</span><span style="color:#3F3D8F">Tech</span>
        </h1>
      </div>

      <!-- Nav (oculto hasta login) -->
      <nav id="mainNav" class="ml-6 flex gap-1 text-sm hidden-vis">
        <a href="#/resumen"  class="px-3 py-2 nav-link">Resumen</a>
        <a href="#/acuerdos" class="px-3 py-2 nav-link">Acuerdos</a>
        <a href="#/metas"    class="px-3 py-2 nav-link">Metas</a>
        <a href="#/luces"    class="px-3 py-2 nav-link">Luces</a>
        <a href="#/juegos"   class="px-3 py-2 nav-link">Juegos</a>
        <a href="#/ajustes"  class="px-3 py-2 nav-link">Ajustes</a>
      </nav>

      <!-- Acciones (ocultas hasta login) -->
      <div id="authActions" class="ml-auto flex items-center gap-2 hidden-vis">
        <button id="themeToggle" class="gs-btn flex items-center justify-center" title="Cambiar tema" aria-label="Cambiar tema">
          <span id="themeIcon" class="inline-block" aria-hidden="true">
            <svg class="gs-icon" viewBox="0 0 24 24" fill="none"><circle cx="12" cy="12" r="5" stroke="currentColor" stroke-width="1.5"/></svg>
          </span>
        </button>

        <div class="relative group">
          <div class="gs-btn flex items-center justify-center" aria-label="Usuario">
            <svg class="gs-icon" viewBox="0 0 24 24" fill="none">
              <path d="M12 12a5 5 0 1 0-5-5 5 5 0 0 0 5 5Zm0 2c-4 0-7 2-7 4v2h14v-2c0-2-3-4-7-4Z" stroke="currentColor" stroke-width="1.5"/>
            </svg>
          </div>
          <div id="userTooltip" class="tooltip hidden group-hover:block"></div>
        </div>

        <button id="logoutBtn" class="gs-btn flex items-center justify-center" title="Salir" aria-label="Salir">
          <svg class="gs-icon" viewBox="0 0 24 24" fill="none">
            <path d="M9 7V5a2 2 0 0 1 2-2h7v18h-7a2 2 0 0 1-2-2v-2" stroke="currentColor" stroke-width="1.5"/>
            <path d="M7 12h10M7 12l3-3M7 12l3 3" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
          </svg>
        </button>
      </div>
    </div>
  </header>

  <!-- Main -->
  <main class="max-w-5xl mx-auto px-4 py-6">
    <!-- Auth -->
    <section id="authCard" class="gs-card p-6 max-w-md mx-auto mt-10">
      <h2 class="text-xl font-semibold mb-4">Iniciar sesión</h2>
      <form id="loginForm" class="space-y-3">
        <div>
          <label class="gs-label">Email</label>
          <input id="emailInput" type="email" class="gs-input" autocomplete="username" required>
        </div>
        <div>
          <label class="gs-label">Password</label>
          <input id="passwordInput" type="password" class="gs-input" autocomplete="current-password" required>
        </div>
        <button type="submit" id="loginBtn" class="gs-btn" style="background:#C7A740; color:#0f172a; border-color:transparent">Entrar</button>
      </form>
      <p class="text-xs opacity-70 mt-2">Solo usuarios permitidos (Eddy y Dani).</p>
    </section>

    <!-- App views -->
    <section id="appViews" class="space-y-6 hidden-vis">
      <!-- Resumen -->
      <div id="view-resumen" class="gs-card p-5">
        <div class="flex items-center justify-between mb-4">
          <h2 class="text-lg font-semibold">Resumen</h2>
          <span class="text-xs opacity-70">v0.1</span>
        </div>
        <div id="resumeStats" class="grid grid-cols-1 sm:grid-cols-3 gap-4"></div>
      </div>

      <!-- Ajustes · Contactos -->
      <div id="view-ajustes" class="gs-card p-5">
        <div class="flex items-center justify-between mb-4">
          <h2 class="text-lg font-semibold">Ajustes · Contactos</h2>
          <div class="flex items-center gap-2">
            <select id="filterStatus" class="gs-input !w-auto text-sm">
              <option value="">Todos</option>
              <option>Bloqueado</option>
              <option>Silenciado</option>
              <option>Archivado</option>
              <option>Eliminado</option>
              <option>Inaccesible</option>
              <option>Conservado</option>
            </select>
            <button id="addContactFab" class="gs-btn">+ Agregar</button>
          </div>
        </div>
        <div id="contactsList" class="grid gap-3"></div>
      </div>

      <!-- Placeholders -->
      <div id="view-acuerdos" class="gs-card p-5 hidden-vis"><h2 class="text-lg font-semibold mb-2">Acuerdos</h2><p class="opacity-70 text-sm">Próxima fase.</p></div>
      <div id="view-metas"   class="gs-card p-5 hidden-vis"><h2 class="text-lg font-semibold mb-2">Metas</h2><p class="opacity-70 text-sm">Próxima fase.</p></div>
      <div id="view-luces"   class="gs-card p-5 hidden-vis"><h2 class="text-lg font-semibold mb-2">Luces</h2><p class="opacity-70 text-sm">Próxima fase.</p></div>
      <div id="view-juegos"  class="gs-card p-5 hidden-vis"><h2 class="text-lg font-semibold mb-2">Juegos</h2><p class="opacity-70 text-sm">Próxima fase.</p></div>
    </section>
  </main>

  <!-- Modal Contacto (CRUD) -->
  <dialog id="contactModal" class="rounded-2xl w-full max-w-lg p-0 backdrop:bg-black/50">
    <form id="contactForm" method="dialog" class="gs-card p-5">
      <div class="flex items-center justify-between mb-3">
        <h3 id="modalTitle" class="text-lg font-semibold">Nuevo contacto</h3>
        <button type="button" id="closeModal" class="opacity-70 hover:opacity-100">✕</button>
      </div>

      <input type="hidden" id="contactId">

      <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
        <div>
          <label class="gs-label">Owner</label>
          <select id="ownerInput" class="gs-input" required>
            <option value="Eddy">Eddy</option>
            <option value="Dani">Dani</option>
          </select>
        </div>
        <div class="sm:col-span-2">
          <label class="gs-label">Nombre / Alias</label>
          <div class="grid grid-cols-1 sm:grid-cols-2 gap-2">
            <input id="nameInput"  class="gs-input" placeholder="Nombre" required>
            <input id="aliasInput" class="gs-input" placeholder="Alias (opcional)">
          </div>
        </div>
        <div>
          <label class="gs-label">Clasificación</label>
          <select id="categoryInput" class="gs-input">
            <option>Rojo</option><option>Ámbar</option><option>Verde</option><option>Azul</option>
          </select>
        </div>
        <div>
          <label class="gs-label">Estado actual</label>
          <select id="statusInput" class="gs-input">
            <option></option>
            <option>Bloqueado</option><option>Silenciado</option><option>Archivado</option>
            <option>Eliminado</option><option>Inaccesible</option><option>Conservado</option>
          </select>
        </div>
        <div class="sm:col-span-2">
          <label class="gs-label">Trato</label>
          <select id="treatmentInput" class="gs-input">
            <option></option>
            <option>Eliminar</option>
            <option>Bloquear</option>
            <option>Silenciar</option>
            <option>Mantener para temas no sensibles</option>
            <option>Archivar</option>
            <option>Responder y bloquear</option>
            <option>Responder y eliminar</option>
          </select>
        </div>
        <div class="sm:col-span-2">
          <label class="gs-label">Notas</label>
          <textarea id="notesInput" class="gs-input" rows="3"></textarea>
        </div>
      </div>

      <div class="mt-4 flex justify-end gap-2">
        <button type="button" id="deleteBtn" class="gs-btn hidden-vis" style="border-color:rgba(255,255,255,.30);background:rgba(255,255,255,.20);color:#fecaca">Eliminar</button>
        <button class="gs-btn" style="background:#C7A740; color:#0f172a; border-color:transparent">Guardar</button>
      </div>
    </form>
  </dialog>

  <!-- Toasts -->
  <div id="toastHost" class="fixed bottom-4 right-4 space-y-2"></div>

  <!-- Config (PON AQUÍ TU ANON KEY REAL) -->
  <script>
    window.__NT_CONFIG__ = {
      supabaseUrl: "https://zhavnscqhsedrvokeocb.supabase.co",
      supabaseAnonKey: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InpoYXZuc2NxaHNlZHJ2b2tlb2NiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg0ODQ1MDcsImV4cCI6MjA3NDA2MDUwN30.Lace39ORNPoDb5iGz8_hlRTRhH3I1JhvD5sPKwzOiys"
    };
  </script>

  <!-- App scripts -->
  <script src="https://unpkg.com/@supabase/supabase-js@2.47.10/dist/umd/supabase.js"></script>
  <script src="./app.js"></script>
  <script src="./ui.js"></script>
</body>
</html>
